<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>隨機圖片與句型練習 (修正版)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }

        /* 圖片容器樣式 */
        #image-container {
            min-height: 250px; /* 確保容器有足夠的空間顯示最大的圖片 */
            margin-bottom: 20px;
        }

        /* 圖片樣式 */
        #random-image {
            max-width: 90%;
            height: auto;
            border: 1px solid #ccc;
            padding: 5px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }

        /* 按鈕樣式 */
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #28a745; /* 更改按鈕顏色 */
            color: white;
            border: none;
            border-radius: 5px;
            margin-bottom: 20px;
        }

        button:hover {
            background-color: #1e7e34;
        }

        /* 句型容器樣式 */
        #sentence-container {
            font-size: 26px; /* 字體加大 */
            margin-top: 30px;
            font-weight: bold;
        }

        /* 統一的方框樣式 (地點和 Be 動詞) */
        .reveal-box {
            display: inline-block;
            min-width: 60px; /* 最小寬度 */
            height: 30px;
            line-height: 30px;
            border: 2px solid #333;
            background-color: #f0f0f0;
            cursor: pointer;
            text-align: center;
            color: transparent; /* 預設文字透明 */
            user-select: none;
            padding: 0 5px; /* 內邊距 */
            margin-left: 5px;
            margin-right: 5px;
            transition: all 0.3s;
        }

        /* 點擊後顯示文字的樣式 */
        .reveal-box.revealed {
            color: #333; /* 顯示文字 */
            background-color: #e6ffe6; /* 變淺綠色表示已顯示 */
            border-color: #28a745;
        }
        
        /* 針對地點方框設置更大的寬度 */
        .location-box {
            min-width: 150px;
        }
    </style>
</head>
<body>

    <h1>隨機圖片與句型練習 (修正版)</h1>

    <button onclick="displayRandomContent()">點擊顯示新的圖片與句型</button>

    <div id="image-container">
        </div>

    <div id="sentence-container">
        </div>

    <script>
        // 圖片檔案名和對應的英文單字/地點
        const images = [
            { fileName: "p44_1.jpg", word: "bank" },
            { fileName: "p44_2.jpg", word: "bookstore" },
            { fileName: "p44_3.jpg", word: "hospital" },
            { fileName: "p44_4.jpg", word: "library" },
            { fileName: "p44_5.jpg", word: "museum" },
            { fileName: "p44_6.jpg", word: "park" },
            { fileName: "p44_7.jpg", word: "post office" },
            { fileName: "p44_8.jpg", word: "supermarket" }
        ];

        // 主詞列表
        const subjects = [
            "He", "We", "She", "The students", "I", "My mother",
            "You", "They", "The nurse", "His father", "Amber",
            "Teddy", "Rocky", "Mia", "Mia and Amy"
        ];

        /**
         * 根據主詞判斷正確的 be 動詞
         * @param {string} subject - 主詞
         * @returns {string} - 正確的 be 動詞 (am, is, are)
         */
        function getBeVerb(subject) {
            // 單數 I
            if (subject === "I") {
                return "am";
            }
            // 單數 He, She, My mother, The nurse, His father, Amber, Teddy, Rocky, Mia
            if (["He", "She", "My mother", "The nurse", "His father", "Amber", "Teddy", "Rocky", "Mia"].includes(subject)) {
                return "is";
            }
            // 複數 We, You, They, The students, 包含 "and" 的多個主詞
            return "are";
        }

        // 隨機選擇主詞
        function getRandomSubject() {
            const randomIndex = Math.floor(Math.random() * subjects.length);
            return subjects[randomIndex];
        }

        // 隨機選擇圖片和單字
        function getRandomImage() {
            const randomIndex = Math.floor(Math.random() * images.length);
            return images[randomIndex];
        }

        // 顯示隨機內容
        function displayRandomContent() {
            const selectedImage = getRandomImage();
            const selectedSubject = getRandomSubject();
            const correctBeVerb = getBeVerb(selectedSubject);

            // 顯示圖片
            const imageContainer = document.getElementById('image-container');
            imageContainer.innerHTML = `<img id="random-image" src="${selectedImage.fileName}" alt="Location Image">`;
            
            // 構建句型
            const sentenceContainer = document.getElementById('sentence-container');
            
            // Be 動詞方框 HTML
            const beVerbBoxHtml = `<span class="reveal-box be-verb-box" 
                                        data-word="${correctBeVerb}" 
                                        onclick="revealAnswer(this)">
                                        ${correctBeVerb}
                                    </span>`;
            
            // 地點方框 HTML
            const locationBoxHtml = `<span class="reveal-box location-box" 
                                          data-word="${selectedImage.word}" 
                                          onclick="revealAnswer(this)">
                                          ${selectedImage.word}
                                     </span>`;

            // 完整句型：主詞 + be 動詞(方框) + going to the + 地點(方框)
            const sentence = `${selectedSubject} ${beVerbBoxHtml} going to the ${locationBoxHtml}.`;

            // 顯示句型
            sentenceContainer.innerHTML = sentence;
        }

        /**
         * 點擊方框顯示答案
         * @param {HTMLElement} element - 被點擊的方框元素
         */
        function revealAnswer(element) {
            // 檢查是否已經顯示
            if (!element.classList.contains('revealed')) {
                // 獲取儲存的單字/答案
                const answer = element.getAttribute('data-word');
                // 設置文字內容
                element.textContent = answer;
                // 添加 revealed class 來改變樣式
                element.classList.add('revealed');
            }
        }

        // 頁面載入時先初始化顯示一次
        window.onload = displayRandomContent; 
    </script>

</body>
</html>